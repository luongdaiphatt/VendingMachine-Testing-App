<Window x:Class="VendingMachineTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Vending Machine Tester" Height="650" Width="900"
        WindowStartupLocation="CenterScreen" Background="#F4F6F8"
        WindowState="Maximized">

    <Grid Margin="15">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Text="Vending Machine Communication Tester"
                   FontSize="22" FontWeight="Bold"
                   Margin="0 0 0 15"/>

        <!-- COMMUNICATION OPTIONS -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="30"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- COM PORT -->
            <GroupBox Header="Serial Port (COM)" FontWeight="Bold" Margin="0 0 10 0"
                      Background="White" BorderBrush="#4A90E2"
                      Padding="10">
                <StackPanel>

                    <TextBlock Text="Select Port:" Margin="0 0 0 5"/>
                    <ComboBox x:Name="ComboPorts" Height="32" Width="200" />

                    <StackPanel Orientation="Horizontal" Margin="0 10 0 10">
                        <Button x:Name="BtnConnect" Content="Connect"
                                Width="100" Height="32" Margin="0 0 10 0"
                                Background="#4CAF50" Foreground="White"
                                FontWeight="SemiBold"/>

                        <Button x:Name="BtnDisconnect" Content="Disconnect"
                                Width="100" Height="32"
                                Background="#D9534F" Foreground="White"
                                FontWeight="SemiBold" IsEnabled="False"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Row, Column, Quantity:" Margin="0 0 20 0"/>
                        <TextBox x:Name="MachineID" Height="32" Width="150"  Margin="0 0 5 0"/>
                        <Button x:Name="BtnSend" Content="Send"
                                Width="75" Height="32" Margin="0 0 10 0"
                                Background="#4CAF50" Foreground="White"
                                FontWeight="SemiBold"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <TextBlock Grid.Column="1" Text="OR" VerticalAlignment="Center"
                       FontWeight="Bold" Foreground="#555" HorizontalAlignment="Center"/>

            <!-- SIGNALR -->
            <GroupBox Grid.Column="2" Header="SignalR Simulator" FontWeight="Bold"
                      Background="White" BorderBrush="#FF9800"
                      Padding="10">
                <StackPanel>

                    <TextBlock Text="Server URL:" Margin="0 0 0 5"/>
                    <TextBox x:Name="tbUrl" Height="32" Width="250"/>

                    <StackPanel Orientation="Horizontal" Margin="0 10 0 10">
                        <Button x:Name="BtnConnectUrl" Content="Connect"
                                Width="100" Height="32" Margin="0 0 10 0"
                                Background="#4CAF50" Foreground="White"
                                FontWeight="SemiBold"/>

                        <Button x:Name="BtnDisconnectUrl" Content="Disconnect"
                                Width="100" Height="32"
                                Background="#D9534F" Foreground="White"
                                FontWeight="SemiBold" IsEnabled="False"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Row, Column, Quantity:" Margin="0 0 20 0"/> 
                        <TextBox x:Name="MachineIDD" Height="32" Width="150"  Margin="0 0 5 0"/>
                        <Button x:Name="BtnSendd" Content="Send"
                                Width="75" Height="32" Margin="0 0 10 0"
                                Background="#4CAF50" Foreground="White"
                                FontWeight="SemiBold"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>
        </Grid>

        <!-- LOG WINDOW -->
        <GroupBox Grid.Row="2" Header="Logs" Margin="0 15 0 0" Background="White" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- 🟩 Text Log (raw communication) -->
                <GroupBox Header="Communication Log" Margin="0 0 10 0">
                    <TextBox x:Name="TxtLog" FontFamily="Consolas" FontSize="13"
                     TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"
                     AcceptsReturn="True" IsReadOnly="True"
                     Background="#000" Foreground="#00FF21"/>
                </GroupBox>

                <!-- 🟦 Bảng Log Giá trị -->
                <GroupBox Grid.Column="1" Header="Operation Log (Giá trị kiểm/nhả hàng)">
                    <DataGrid x:Name="GridOperationLog" 
                      AutoGenerateColumns="False" 
                      IsReadOnly="True"
                      HeadersVisibility="Column"
                      CanUserAddRows="False"
                      Margin="0"
                      AlternatingRowBackground="#F0F8FF"
                      GridLinesVisibility="All">

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Time" Binding="{Binding Time}" Width="100"/>
                            <DataGridTextColumn Header="ID Kênh Hàng" Binding="{Binding ChannelID}" Width="200"/>
                            <DataGridTextColumn Header="Trạng thái truy vấn" Binding="{Binding CheckStatus}" Width="200"/>
                            <DataGridTextColumn Header="Trạng thái xuất hàng" Binding="{Binding ReleaseStatus}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </Grid>
        </GroupBox>
        <Button Grid.Row="3" Width="100" Content="Clear Logs" HorizontalAlignment="Right"
                Margin="0 0 25 0" Click="Button_Click"></Button>
    </Grid>
</Window>
